<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>6.2. HTTP 経由の実行</title>
    <link rel="stylesheet" href="style.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="start" href="index.html" title="PHPSpec リファレンスマニュアル" />
    <link rel="up" href="execution.methods.for.phpspec.html" title="第6章 PHPSpec の実行方法" />
    <link rel="prev" href="execution.methods.for.phpspec.html" title="第6章 PHPSpec の実行方法" />
    <link rel="next" href="copyrights.html" title="付録 A. 著作権について" />
    <link rel="preface" href="preface.html" title="序文" />
    <link rel="chapter" href="installing.phpspec.html" title="第1章 PHPSpec のインストール" />
    <link rel="chapter" href="getting.started.html" title="第2章 さぁはじめましょう" />
    <link rel="chapter" href="introduction.html" title="第3章 導入" />
    <link rel="chapter" href="phpspecs.goals.html" title="第4章 PHPSpec の目標" />
    <link rel="chapter" href="writing.specs.with.phpspec.html" title="第5章 PHPSpec でのスペックの記述" />
    <link rel="chapter" href="execution.methods.for.phpspec.html" title="第6章 PHPSpec の実行方法" />
    <link rel="appendix" href="copyrights.html" title="付録 A. 著作権について" />
    <link rel="index" href="the.index.html" title="目次" />
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">6.2. HTTP 経由の実行</th>
        </tr>
        <tr>
          <td width="20%" align="left"><a accesskey="p" href="execution.methods.for.phpspec.html">前のページ</a> </td>
          <th width="60%" align="center">第6章 PHPSpec の実行方法</th>
          <td width="20%" align="right"> <a accesskey="n" href="copyrights.html">次のページ</a></td>
        </tr>
      </table>
    </div>
    <div class="section" lang="ja" xml:lang="ja">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title" style="clear: both"><a id="the.http.runner"></a>6.2. HTTP 経由の実行</h2>
          </div>
        </div>
      </div>
      <p>
      HTTP ランナーは、その場ですぐ実行できるというものではありません。
      ウェブブラウザ経由で呼び出したい PHP ファイルについて、
      ちょっとした仕込みを行う必要があります。
      とはいえそれは本当にシンプルな作業なので、
      HTTP 経由での実行もコマンドラインからの実行と同列に扱って説明することにしました。
    </p>
      <p>
      HTTP 経由で実行するためのファイル AllSPecs.php の例を以下に示します。
    </p>
      <pre class="programlisting">&lt;?php

require_once 'PHPSpec.php';

$options = new stdClass;
$options-&gt;recursive = true;
$options-&gt;specdocs = true;
$options-&gt;reporter = 'html';

PHPSpec_Runner::run($options);</pre>
      <p>
      <code class="classname">PHPSpec_Runner</code> クラスは、
      実際にはデフォルトのコンソールランナーで内部的に使用されているものです。
      つまりここで行っているのは非常に単純なことです。
      この例で実際にやっていることは、
      コンソールランナーが内部で行っている作業を PHP ファイルに書き出しているだけで、
      ウェブブラウザから呼び出されたときにもこれを実行できるようにしています。
    </p>
      <p>
      まず、ベースとなるファイル PHPSpec.php をインクルードします。
      PHPSpec は PHP5 の autoload 機能を使用しているので、
      PHPSpec のその他のファイルをインクルードする必要はありません。
      次に、必要なオプションを <code class="classname">stdClass</code>
      (PHP5 の標準クラス) のプロパティとして設定します。
      オプションとして、ふつうの配列を使用することもできます。
      配列で指定しても、内部で自動的にオブジェクトに変換します。
    </p>
      <p>
      ここで指定しているオプションは、すべてのスペックを実行するためのごく一般的なものです。
      PHPSpec はカレントディレクトリ以下を再帰的に検索し、
      みつかったスペックのすべてのサンプルを実行します。
      出力結果には specdoc 形式のプレーンテキストが追加され、
      実行結果は HTML 形式で出力されます。
    </p>
      <p>
      最後に、PHPSpec_Runner の static メソッド run() を実行します。
      これで完了!
      特定のサブディレクトリのスペックだけを実行したいのなら、
      このファイルをそのサブディレクトリにコピーすればいいでしょう
      (再帰検索のオプションは、親ディレクトリは対象外となります)。
    </p>
    </div>
    <div class="navfooter">
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="left"><a accesskey="p" href="execution.methods.for.phpspec.html">前のページ</a> </td>
          <td width="20%" align="center">
            <a accesskey="u" href="execution.methods.for.phpspec.html">上に戻る</a>
          </td>
          <td width="40%" align="right"> <a accesskey="n" href="copyrights.html">次のページ</a></td>
        </tr>
        <tr>
          <td width="40%" align="left" valign="top">第6章 PHPSpec の実行方法 </td>
          <td width="20%" align="center">
            <a accesskey="h" href="index.html">ホーム</a>
          </td>
          <td width="40%" align="right" valign="top"> 付録 A. 著作権について</td>
        </tr>
      </table>
    </div>
    <div xmlns="" class="revinfo"></div>
  </body>
</html>
